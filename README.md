# demixpca ReadMe

This repo contains R code for demixed pca method - a modified dimensional reduction techinique to capture the dependencies
of neurons on task parameters such as stimuli, rewards, and decisions, while still preserving
the principal information from the original data.

## Installation
To install **demixpca** R package:
```
library(devtools)
devtools::install_github("jhgoblue/demixpca")
```
## Getting Started
The package **rsvd** and **pracma** are also required while using the **demixpca**. 

There is a simulated data included in the package, which you can generate using the command:
```
# To generate a simulate data with 50 sample neurons, 200 time parameters and 4 stimulus parameters. 
demixpca::dpca_data_sim(N=50, n_samples=10, pars_lst = c(200, 4), save = FALSE)
```
The simulated_data could be generated by **demixpca::dpca_data_sim()**  
How to fit, transform, and visualize the first demixed principle component on the stimulus task parameter margin:

```
# pars_lst should be consistent with label="ts"
demixpca::dpca_fit_transform(simulated_data, label = 'ts', plot=TRUE, plot_margin = 's')
```
The return of `dpca_fit_transform()` is a list containing flatten matrices, for user to select component easily. One can use `dim()` to transform the martices into the shape of multiple dimensional array (n_feature1, n_feature2, ..., n_components).  
Use **help()** to check detailed description and usage for functions built in **demixpca** package: 
```
help('dpca_fit_transform')
```
Demo implementation can refer to **demixpca_demo.Rmd** file.  
Functions mainly used are: `dpca_data_sim()`, `dpca_fit_transform()`.
## Reference

Kobak, D., Brendel, W., Constantinidis, C., Feierstein, C. E., Kepecs, A., Mainen, Z. F., Qi, X. L., Romo, R., Uchida, N., & Machens, C. K. (2016). Demixed principal component analysis of neural population data. eLife, 5, e10989. https://doi.org/10.7554/eLife.10989  
Python and Matlab package can refer to https://github.com/machenslab/dPCA
